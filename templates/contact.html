{% extends "base.html" %}
{% load static %}

{% block title %}Contact Us | Youth Environmental Scholars{% endblock %}

{% block meta_description %}Get in touch with the Youth Environmental Scholars team. Reach out for partnerships, media inquiries, volunteer opportunities, or general questions about environmental sustainability.{% endblock %}



{% block content %}
<!-- Contact Hero Section -->
<section class="contact-hero">
    <div class="container">
        <div class="text-center animate-fade-in-up">
            <span class="badge badge-primary mb-6 animate-bounce-in">
                <i class="fas fa-envelope mr-2"></i>Get in Touch
            </span>
            <h1 class="display-3 mb-6 animate-fade-in-up" style="animation-delay: 0.2s;">
                Connect With Our Team
            </h1>
            <p class="lead max-w-3xl mx-auto animate-fade-in-up" style="animation-delay: 0.4s;">
                Have questions about environmental programs, research partnerships, or volunteer opportunities? 
                We're here to help you join the movement for a sustainable future.
            </p>
        </div>
    </div>
</section>

<!-- Main Contact Section -->
<section class="section">
    <div class="container">
        <div class="contact-grid">
            <!-- Contact Information -->
            <div class="contact-info-card animate-fade-in-left">
                <h2 class="h2 mb-8 text-primary">Contact Information</h2>
                
                <div class="contact-method">
                    <div class="contact-icon">
                        <i class="fas fa-map-marker-alt"></i>
                    </div>
                    <h4>Our Headquarters</h4>
                    <p>Egerton Way<br>
                    Nakuru City, 20100<br>
                    Kenya</p>
                    <a href="https://www.google.com/maps/place/Egerton+University/@-0.3683,35.9315,15z" target="_blank" rel="noopener">
                        <i class="fas fa-directions mr-2"></i>Get Directions
                    </a>
                </div>
                
                <div class="contact-method">
                    <div class="contact-icon">
                        <i class="fas fa-phone"></i>
                    </div>
                    <h4>Phone & Fax</h4>
                    <p><strong>General Inquiries:</strong> <a href="tel:+254 797 276 480">+254 797 276 480</a></p>
                    <p><strong>Program Support:</strong> <a href="tel:+254 798 798 016">+254 798 7980 168</a></p>
                    <p><strong>Fax:</strong> +254 713 488 507</p>
                </div>
                
                <div class="contact-method">
                    <div class="contact-icon">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <h4>Email Addresses</h4>
                    <p><strong>General:</strong> <a href="mailto:info@youthenvironmentalscholars.org">info@youthenvironmentalscholars.org</a></p>
                    <p><strong>Partnerships:</strong> <a href="mailto:partnerships@youthenvironmentalscholars.org">partnerships@youthenvironmentalscholars.org</a></p>
                    <p><strong>Media Inquiries:</strong> <a href="mailto:media@youthenvironmentalscholars.org">media@youthenvironmentalscholars.org</a></p>
                </div>
                
                <div class="contact-method">
                    <div class="contact-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <h4>Office Hours</h4>
                    <p><strong>Monday - Friday:</strong> 9:00 AM - 6:00 PM EST</p>
                    <p><strong>Saturday:</strong> 10:00 AM - 4:00 PM EST</p>
                    <p><strong>Sunday:</strong> Closed</p>
                    <small class="text-muted">*Virtual consultations available by appointment</small>
                </div>
                
                <div class="contact-method">
                    <div class="contact-icon">
                        <i class="fas fa-share-alt"></i>
                    </div>
                    <h4>Connect Socially</h4>
                    <p>Follow us for updates, events, and environmental news</p>
                    <div class="social-links-horizontal">
                        <a href="#" class="social-link-circle" aria-label="Twitter">
                            <i class="fab fa-twitter"></i>
                        </a>
                        <a href="#" class="social-link-circle" aria-label="LinkedIn">
                            <i class="fab fa-linkedin-in"></i>
                        </a>
                        <a href="#" class="social-link-circle" aria-label="Instagram">
                            <i class="fab fa-instagram"></i>
                        </a>
                        <a href="#" class="social-link-circle" aria-label="Facebook">
                            <i class="fab fa-facebook-f"></i>
                        </a>
                        <a href="#" class="social-link-circle" aria-label="YouTube">
                            <i class="fab fa-youtube"></i>
                        </a>
                    </div>
                </div>
            </div>
            
            <!-- Contact Form -->
            <div class="contact-form-card animate-fade-in-right">
                <div class="form-header">
                    <h3>Send Us a Message</h3>
                    <p>Fill out the form below and we'll get back to you within 24 hours</p>
                </div>
                
                <form id="contactForm" method="POST">
                    {% csrf_token %}
                    <div class="form-row">
                        <div class="form-group">
                            <label for="name" class="form-label">Full Name *</label>
                            <input type="text" id="name" name="name" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="email" class="form-label">Email Address *</label>
                            <input type="email" id="email" name="email" class="form-control" required>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="category" class="form-label">Inquiry Category *</label>
                        <select id="category" name="category" class="form-control" required>
                            <option value="" disabled selected>Select a category</option>
                            <option value="general">General Inquiry</option>
                            <option value="programs">Program Information</option>
                            <option value="partnership">Partnership Opportunities</option>
                            <option value="volunteer">Volunteer Opportunities</option>
                            <option value="media">Media Inquiry</option>
                            <option value="research">Research Collaboration</option>
                            <option value="donation">Donation Inquiry</option>
                            <option value="technical">Technical Support</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="subject" class="form-label">Subject *</label>
                        <input type="text" id="subject" name="subject" class="form-control" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="message" class="form-label">Your Message *</label>
                        <textarea id="message" name="message" class="form-control" required></textarea>
                        <div class="form-text">Please provide as much detail as possible</div>
                    </div>
                    
                    <div class="form-group">
                        <div class="flex items-center">
                            <input type="checkbox" id="newsletter" name="newsletter" class="mr-3">
                            <label for="newsletter" class="form-label mb-0">
                                Subscribe to our newsletter for environmental updates and event invitations
                            </label>
                        </div>
                    </div>
                    
                    <div class="form-submit">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <span class="loading-spinner"></span>
                            Send Message
                        </button>
                    </div>
                    
                    <div class="success-message" id="successMessage">
                        <i class="fas fa-check-circle text-success mr-3"></i>
                        <span>Thank you for your message! We'll get back to you within 24 hours.</span>
                    </div>
                    
                    <div class="error-message" id="errorMessage">
                        <i class="fas fa-exclamation-circle text-danger mr-3"></i>
                        <span>Oops! Something went wrong. Please try again or contact us directly.</span>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Map Section -->
        <div class="map-container animate-fade-in-up">
            <div class="map-placeholder">
                <div class="text-center">
                    <i class="fas fa-map-marked-alt text-4xl mb-4 text-primary"></i>
                    <h4 class="text-xl font-semibold mb-2">Our Location</h4>
                    <p>Egerton University Way, Nakuru City, 20100</p>
                    <a href="https://www.google.com/maps/place/Egerton+University/@-0.3683,35.9315,15z" target="_blank" rel="noopener" class="btn btn-secondary btn-sm mt-4">
                        <i class="fas fa-external-link-alt mr-2"></i>Open in Google Maps
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Department Contacts -->
        <div class="department-contacts animate-fade-in-up">
            <h2 class="h2 text-center mb-6">Contact Specific Departments</h2>
            <p class="text-center text-lg text-neutral-600 max-w-3xl mx-auto mb-12">
                Need to reach a specific team? Here are direct contacts for each department
            </p>
            
            <div class="department-grid">
                <div class="department-card">
                    <div class="department-header">
                        <div class="department-icon">
                            <i class="fas fa-leaf"></i>
                        </div>
                        <div class="department-info">
                            <h4>Programs Department</h4>
                            <p>Environmental initiatives & education</p>
                        </div>
                    </div>
                    <ul class="department-contacts-list">
                        <li>
                            <i class="fas fa-user"></i>
                            <span>Director: Peter Muchiru</span>
                        </li>
                        <li>
                            <i class="fas fa-envelope"></i>
                            <a href="mailto:programs@youthenvironmentalscholars.org">programs@youthenvironmentalscholars.org</a>
                        </li>
                        <li>
                            <i class="fas fa-phone"></i>
                            <a href="tel:+254 713 488 507">+254 713 488 507</a>
                        </li>
                    </ul>
                </div>
                
                <div class="department-card">
                    <div class="department-header">
                        <div class="department-icon">
                            <i class="fas fa-flask"></i>
                        </div>
                        <div class="department-info">
                            <h4>Research Division</h4>
                            <p>Environmental studies & innovation</p>
                        </div>
                    </div>
                    <ul class="department-contacts-list">
                        <li>
                            <i class="fas fa-user"></i>
                            <span>Director: Omondi Byrone</span>
                        </li>
                        <li>
                            <i class="fas fa-envelope"></i>
                            <a href="mailto:research@youthenvironmentalscholars.org">research@youthenvironmentalscholars.org</a>
                        </li>
                        <li>
                            <i class="fas fa-phone"></i>
                            <a href="tel:+254 705 022854">+254 705 022854</a>
                        </li>
                    </ul>
                </div>
                
                <div class="department-card">
                    <div class="department-header">
                        <div class="department-icon">
                            <i class="fas fa-users"></i>
                        </div>
                        <div class="department-info">
                            <h4>Community Outreach</h4>
                            <p>Partnerships & volunteer programs</p>
                        </div>
                    </div>
                    <ul class="department-contacts-list">
                        <li>
                            <i class="fas fa-user"></i>
                            <span>Director: Naomi Makokha</span>
                        </li>
                        <li>
                            <i class="fas fa-envelope"></i>
                            <a href="mailto:outreach@youthenvironmentalscholars.org">outreach@youthenvironmentalscholars.org</a>
                        </li>
                        <li>
                            <i class="fas fa-phone"></i>
                            <a href="tel:+254 798 798016">+254 798 798016</a>
                        </li>
                    </ul>
                </div>
                
                <div class="department-card">
                    <div class="department-header">
                        <div class="department-icon">
                            <i class="fas fa-hand-holding-heart"></i>
                        </div>
                        <div class="department-info">
                            <h4>Donor Relations</h4>
                            <p>Sponsorships & funding</p>
                        </div>
                    </div>
                    <ul class="department-contacts-list">
                        <li>
                            <i class="fas fa-user"></i>
                            <span>Director: Antony Aluvale</span>
                        </li>
                        <li>
                            <i class="fas fa-envelope"></i>
                            <a href="mailto:donors@youthenvironmentalscholars.org">donors@youthenvironmentalscholars.org</a>
                        </li>
                        <li>
                            <i class="fas fa-phone"></i>
                            <a href="tel:+254 797 276 480">+254 797 276 480</a>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- FAQ Section -->
        <div class="faq-section animate-fade-in-up">
            <h2 class="h2 text-center mb-6">Frequently Asked Questions</h2>
            <p class="text-center text-lg text-neutral-600 max-w-3xl mx-auto mb-12">
                Quick answers to common questions about contacting us
            </p>
            
            <div class="faq-accordion">
                <div class="faq-item">
                    <div class="faq-question">
                        <span>How quickly will I receive a response to my inquiry?</span>
                        <i class="fas fa-chevron-down faq-toggle"></i>
                    </div>
                    <div class="faq-answer">
                        <p>We aim to respond to all inquiries within 24 hours during business days. For urgent matters, please call our main office line. Program-specific inquiries may take 2-3 business days as they are routed to the appropriate department.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>Do you offer virtual consultations or meetings?</span>
                        <i class="fas fa-chevron-down faq-toggle"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Yes! We offer virtual consultations via Zoom, Microsoft Teams, or Google Meet. You can request a virtual meeting through our contact form or by calling our office to schedule an appointment.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>What information should I include in my partnership inquiry?</span>
                        <i class="fas fa-chevron-down faq-toggle"></i>
                    </div>
                    <div class="faq-answer">
                        <p>For partnership inquiries, please include: your organization's name and mission, proposed collaboration ideas, desired outcomes, timeline, and contact information. This helps us direct your inquiry to the right team member.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>How can I schedule a school visit or presentation?</span>
                        <i class="fas fa-chevron-down faq-toggle"></i>
                    </div>
                    <div class="faq-answer">
                        <p>To schedule educational visits or presentations, please contact our Programs Department directly. Include your school/organization name, grade levels, preferred dates, topics of interest, and any specific requirements.</p>
                    </div>
                </div>
                
                <div class="faq-item">
                    <div class="faq-question">
                        <span>What are your office hours for phone support?</span>
                        <i class="fas fa-chevron-down faq-toggle"></i>
                    </div>
                    <div class="faq-answer">
                        <p>Our phone lines are staffed Monday-Friday, 9:00 AM - 6:00 PM EST, and Saturdays, 10:00 AM - 4:00 PM EST. Outside these hours, you can leave a voicemail or send us an email, and we'll respond during the next business day.</p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Contact CTA -->
        <div class="contact-cta animate-fade-in-up">
            <h2 class="h2 mb-6">Still Have Questions?</h2>
            <p class="text-xl text-neutral-700 mb-8 max-w-2xl mx-auto">
                Join one of our virtual information sessions or browse our comprehensive knowledge base
            </p>
            <div class="flex flex-col sm:flex-row gap-6 justify-center">
                <a href="/events/" class="btn btn-primary btn-lg">
                    <i class="fas fa-calendar-alt mr-3"></i>
                    View Upcoming Events
                </a>
                <a href="/faq/" class="btn btn-outline-primary btn-lg">
                    <i class="fas fa-question-circle mr-3"></i>
                    Visit Full FAQ
                </a>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
    // Contact Page JavaScript
    document.addEventListener('DOMContentLoaded', function() {
        initializeContactForm();
        initializeFAQAccordion();
        initializeFormValidation();
        initializeDepartmentCards();
        initializeMapInteractions();
        
        console.log('ðŸ“ž Contact page initialized');
    });
    
    function initializeContactForm() {
        const contactForm = document.getElementById('contactForm');
        const submitBtn = contactForm.querySelector('button[type="submit"]');
        const successMessage = document.getElementById('successMessage');
        const errorMessage = document.getElementById('errorMessage');
        
        if (!contactForm) return;
        
        contactForm.addEventListener('submit', async function(e) {
            e.preventDefault();
            
            // Validate form
            if (!validateContactForm()) {
                return;
            }
            
            // Show loading state
            submitBtn.classList.add('loading');
            submitBtn.disabled = true;
            
            // Hide any previous messages
            successMessage.classList.remove('active');
            errorMessage.classList.remove('active');
            
            try {
                // Get CSRF token
                const csrfToken = document.querySelector('[name=csrfmiddlewaretoken]').value;
                
                // Prepare form data
                const formData = new FormData(contactForm);
                const data = {
                    name: formData.get('name'),
                    email: formData.get('email'),
                    subject: formData.get('subject'),
                    message: formData.get('message'),
                    category: formData.get('category'),
                    newsletter: formData.get('newsletter') === 'on'
                };
                
                // Send to your API endpoint
                const response = await fetch('/api/core/contact/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': csrfToken
                    },
                    body: JSON.stringify(data)
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    // Success
                    successMessage.classList.add('active');
                    contactForm.reset();
                    
                    // Scroll to success message
                    successMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    
                    // Hide success message after 5 seconds
                    setTimeout(() => {
                        successMessage.classList.remove('active');
                    }, 5000);
                } else {
                    // Error from server
                    errorMessage.querySelector('span').textContent = result.error || 'Failed to send message. Please try again.';
                    errorMessage.classList.add('active');
                    errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
                
            } catch (error) {
                console.error('Form submission error:', error);
                errorMessage.querySelector('span').textContent = 'Network error. Please check your connection and try again.';
                errorMessage.classList.add('active');
                errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
            } finally {
                // Reset button state
                submitBtn.classList.remove('loading');
                submitBtn.disabled = false;
            }
        });
    }
    
    function validateContactForm() {
        const form = document.getElementById('contactForm');
        let isValid = true;
        
        // Clear previous errors
        clearAllFieldErrors();
        
        // Validate required fields
        const requiredFields = form.querySelectorAll('[required]');
        requiredFields.forEach(field => {
            if (!field.value.trim()) {
                markFieldInvalid(field);
                isValid = false;
            }
        });
        
        // Validate email format
        const emailField = form.querySelector('#email');
        if (emailField.value.trim()) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(emailField.value)) {
                markFieldInvalid(emailField, 'Please enter a valid email address');
                isValid = false;
            }
        }
        
        return isValid;
    }
    
    function markFieldInvalid(field, message = 'This field is required') {
        field.classList.add('error');
        field.style.borderColor = 'var(--error-500)';
        
        // Remove any existing error message
        const existingError = field.parentNode.querySelector('.field-error');
        if (existingError) existingError.remove();
        
        // Add error message
        const errorDiv = document.createElement('div');
        errorDiv.className = 'field-error';
        errorDiv.style.color = 'var(--error-600)';
        errorDiv.style.fontSize = 'var(--text-sm)';
        errorDiv.style.marginTop = 'var(--space-1)';
        errorDiv.textContent = message;
        field.parentNode.appendChild(errorDiv);
    }
    
    function clearFieldError(field) {
        field.classList.remove('error');
        field.style.borderColor = '';
        
        const errorDiv = field.parentNode.querySelector('.field-error');
        if (errorDiv) errorDiv.remove();
    }
    
    function clearAllFieldErrors() {
        const errorFields = document.querySelectorAll('.error');
        errorFields.forEach(field => clearFieldError(field));
    }
    
    function initializeFAQAccordion() {
        const faqItems = document.querySelectorAll('.faq-item');
        
        faqItems.forEach(item => {
            const question = item.querySelector('.faq-question');
            const answer = item.querySelector('.faq-answer');
            
            question.addEventListener('click', function() {
                const isActive = item.classList.contains('active');
                
                // Close all FAQ items
                faqItems.forEach(faq => {
                    faq.classList.remove('active');
                    faq.querySelector('.faq-answer').classList.remove('active');
                });
                
                // Open clicked item if it was closed
                if (!isActive) {
                    item.classList.add('active');
                    answer.classList.add('active');
                }
            });
        });
    }
    
    function initializeFormValidation() {
        const formInputs = document.querySelectorAll('#contactForm input, #contactForm textarea, #contactForm select');
        
        formInputs.forEach(input => {
            input.addEventListener('blur', function() {
                if (this.hasAttribute('required') && !this.value.trim()) {
                    markFieldInvalid(this);
                } else if (this.type === 'email' && this.value.trim()) {
                    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                    if (!emailRegex.test(this.value)) {
                        markFieldInvalid(this, 'Please enter a valid email address');
                    } else {
                        clearFieldError(this);
                    }
                } else {
                    clearFieldError(this);
                }
            });
            
            input.addEventListener('input', function() {
                if (this.classList.contains('error')) {
                    clearFieldError(this);
                }
            });
        });
    }
    
    function initializeDepartmentCards() {
        const departmentCards = document.querySelectorAll('.department-card');
        
        departmentCards.forEach(card => {
            card.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-4px)';
            });
            
            card.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0)';
            });
        });
    }
    
    function initializeMapInteractions() {
        const mapContainer = document.querySelector('.map-container');
        
        if (mapContainer) {
            mapContainer.addEventListener('click', function() {
                window.open('https://www.google.com/maps/place/Egerton+University/@-0.3683,35.9315,15z', '_blank');
            });
            
            mapContainer.addEventListener('mouseenter', function() {
                this.style.cursor = 'pointer';
                this.style.transform = 'scale(1.02)';
            });
            
            mapContainer.addEventListener('mouseleave', function() {
                this.style.transform = 'scale(1)';
            });
        }
    }
    
    // Auto-fill form from URL parameters
    function populateFormFromURL() {
        const urlParams = new URLSearchParams(window.location.search);
        const form = document.getElementById('contactForm');
        
        if (form && urlParams) {
            urlParams.forEach((value, key) => {
                const field = form.querySelector(`[name="${key}"]`);
                if (field) {
                    field.value = value;
                }
            });
            
            // Set category from query parameter
            const category = urlParams.get('category');
            if (category) {
                const categorySelect = form.querySelector('#category');
                if (categorySelect) {
                    categorySelect.value = category;
                }
            }
        }
    }
    
    // Call auto-fill on page load
    populateFormFromURL();
    
    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
        // Submit form with Ctrl+Enter
        if (e.ctrlKey && e.key === 'Enter') {
            const form = document.getElementById('contactForm');
            if (form) {
                form.requestSubmit();
            }
        }
    });
</script>
{% endblock %}
